# Руководство пользователя ncrew (MVP)

Документ описывает сценарии работы, горячие клавиши и формат настроек для минимальной версии ncrew.

## Перед началом работы
1. Установите оригинальные CLI-клиенты агентов, с которыми планируется работать:
   - [Claude Code](https://github.com/anthropics/claude-code)
   - [OpenAI Codex CLI](https://github.com/openai/codex)
   - [Gemini CLI](https://github.com/google-gemini/gemini-cli)
   - [Qwen CLI](https://github.com/QwenLM/qwen-code)
   - [Opencode](https://github.com/sst/opencode)
2. Убедитесь, что бинарные файлы доступны в `PATH` и поддерживают формат вызова `cli "message"`.
3. Создайте файл настроек `~/.ncrew/settings.json` на основе шаблона из [архитектурного документа](architecture.md).

## Запуск
```bash
ncrew
```

Альтернатива через модуль:

```bash
python -m ncrew
```

Для чтения альтернативного файла настроек укажите путь вручную:

```bash
ncrew --config /path/to/settings.json
```

При старте приложение загружает `~/.ncrew/settings.json`, инициализирует зарегистрированных агентов и открывает TUI. Ошибки чтения
настроек отображаются в нижней панели статуса.

## Горячие клавиши MVP
| Действие                          | Комбинация |
|-----------------------------------|------------|
| Отправить сообщение всему составу | `Enter`    |
| Открыть окно справки              | `?`        |
| Обновить список агентов (перечитать настройки) | `Ctrl+R` |
| Выход                             | `Ctrl+C`   |

Раскладка может быть расширена на последующих этапах, но текущий набор покрывает минимальный сценарий общения.

## Потоки работы
1. **Отправка сообщений**: ввод текста в поле ввода, подтверждение `Enter`. Приложение рассылает сообщение всем агентам и выводит их ответы по очереди в общем журнале.
2. **Обновление конфигурации**: после изменения `settings.json` нажмите `Ctrl+R`, чтобы перезагрузить список агентов без перезапуска приложения.
3. **Обработка ошибок**: сообщения об ошибках запуска или завершения процесса выводятся в отдельной зоне статуса; пользователь может перезапустить агента или обновить настройки.

## Формат настроек
Минимальный пример `~/.ncrew/settings.json` (такой же файл доступен в репозитории как `examples/settings.sample.json`):
```json
{
  "agents": [
    {
      "id": "claude",
      "name": "Claude Code",
      "command": "claude-code chat"
    },
    {
      "id": "gemini",
      "name": "Gemini CLI",
      "command": "gemini-cli run"
    }
  ],
  "ui": {
    "theme": "default",
    "history_limit": 200,
    "show_timestamps": true
  }
}
```

### Обязательные поля
- `agents` — список объектов с полями `id`, `name`, `command`.

### Дополнительные поля
- `ui.theme` — название темы оформления (для MVP доступна только `default`).
- `ui.history_limit` — максимальное количество сообщений, хранимое в памяти.
- `ui.show_timestamps` — включение/выключение отображения времени сообщений.

Строка `command` может быть указана двумя способами:
- как базовая команда, к которой приложение добавит сообщение последним аргументом (`"command": "claude-code chat"`);
- с подстановкой `{message}` внутри строки. В этом случае сообщение автоматически экранируется (`"command": "codex {message}"`).

Приложение валидирует структуру и сообщает о проблемах через панель статуса.

Порядок агентов в списке определяет последовательность, в которой они получают сообщение и отвечают пользователю.

## Ограничения MVP
- Нет личных сообщений и групповых действий между агентами.
- Нет сохранения истории на диск.
- Нет автоматической установки или обновления внешних CLI.
- Нет графического режима, только терминал.

## Обратная связь
Пожелания по функциональности и баг-репорты приветствуются через issues после публикации репозитория.
