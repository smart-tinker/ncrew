# Пользовательские истории и целевой сценарий

Документ фиксирует согласованный набор пользовательских историй для MVP ncrew и целевую
последовательность действий, вокруг которой строится план реализации.

## Персоны
- **Оператор ncrew** — пользователь терминала, который запускает интерфейс и
  взаимодействует с несколькими ИИ-агентами через их официальные CLI-клиенты.
- **Администратор окружения** — тот же оператор или инженер поддержки, который
  подготавливает настройки и следит за корректной конфигурацией.

## Пользовательские истории
1. **Подготовка конфигурации**
   - Как администратор окружения, я хочу создать файл `~/.ncrew/settings.json`
     с описанием доступных CLI-агентов и параметров TUI, чтобы приложение знало,
     какие процессы запускать и какое начальное состояние показывать.
   - Критерии приёмки:
     - Существуют все упомянутые CLI-клиенты, доступные в PATH.
     - Конфигурация проходит валидацию при старте и при ручной перезагрузке.

2. **Запуск и обзор состояния**
   - Как оператор ncrew, я хочу запустить терминальный интерфейс и увидеть список
     доступных агентов и пустую историю чата, чтобы выбрать нужного собеседника.
   - Критерии приёмки:
     - Приложение запускается командой `ncrew` или `python -m ncrew`.
     - В TUI отображаются список агентов, история и подсказка горячих клавиш.

3. **Рассылка сообщения всему составу**
   - Как оператор ncrew, я хочу ввести сообщение и автоматически получить
     последовательные ответы от всех подключённых CLI-агентов, чтобы вести
     групповой разговор без ручного выбора адресата.
   - Критерии приёмки:
     - Сообщение отправляется клавишей `Enter` и отображается в общей истории.
     - Ответы агентов выводятся по одному, в фиксированном порядке, с пометкой источника.
     - Ошибки запуска любого агента не блокируют остальных и отображаются в статусной строке.

4. **Обновление настроек без перезапуска**
   - Как администратор окружения, я хочу изменить `settings.json` и применить
     изменения без перезапуска приложения, чтобы оперативно добавлять новых
     агентов или корректировать команды.
   - Критерии приёмки:
     - Комбинация `Ctrl+R` перечитывает настройки и обновляет список агентов.
     - Пользователь получает уведомление об успехе или ошибке валидации.

## Целевая последовательность действий
1. Подготовить окружение: установить Python 3.10+, необходимые CLI-клиенты и
   создать каталог `~/.ncrew`.
2. Сформировать `~/.ncrew/settings.json` по шаблону руководства, указав минимум
   один доступный агент и желаемые параметры TUI.
3. Запустить приложение командой `ncrew` и убедиться, что список агентов
   отображается в интерфейсе.
4. Ввести сообщение и дождаться, пока каждый агент по очереди ответит в общем журнале.
5. При изменении настроек нажать `Ctrl+R`, убедиться, что список агентов
   обновился, продолжить работу или устранить ошибки по сообщениям статуса.
6. Завершить сеанс стандартным способом (горячая клавиша `Ctrl+C` или действие в
   интерфейсе Textual).

## Связь с планом проекта
- Истории 1–2 формируют фундаментальные задачи по загрузке конфигурации,
  каркасу TUI и отображению состояния.
- История 3 описывает групповой обмен сообщениями и последовательные ответы — это
  сердцевина MVP и основное отличие от классического «один агент за раз».
- История 4 фиксирует требование к горячей клавише перезагрузки настроек и
  обеспечивает гибкость без перезапуска.
- Дополнительные функции (история на диск, личные сообщения, аналитика) остаются
  вне MVP и могут появиться как отдельные истории после базового релиза.
