# MVP –õ–æ–∫–∞–ª—å–Ω–æ–≥–æ –í–µ–±-–ß–∞—Ç–∞

## –û–ø–∏—Å–∞–Ω–∏–µ

–õ–æ–∫–∞–ª—å–Ω—ã–π –≤–µ–±-—á–∞—Ç —Å–ª—É–∂–∏—Ç **—Ä–µ–∑–µ—Ä–≤–Ω—ã–º –ø—É—Ç–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è** Telegram-–≥—Ä—É–ø–ø—ã. –ï—Å–ª–∏ Telegram API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –∞–≥–µ–Ω—Ç–∞–º–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì± **–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —á–∞—Ç UI** - –æ—Ç–ø—Ä–∞–≤–∫–∞/–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ä–µ–∞–ª-—Ç–∞–π–º–µ
- ü§ñ **–í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ —Ä–æ–ª–µ–π** - —Ä–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
- üåì **Dark mode** - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Å–≤–µ—Ç–ª–æ–π –∏ —Ç–µ–º–Ω–æ–π —Ç–µ–º–æ–π
- üìä **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –æ–¥–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (FileStorage) –¥–ª—è Telegram –∏ –≤–µ–±–∞
- üîê **Basic Auth** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚ö° **Real-time polling** - –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–æ—Å—Ç—É–ø –∫ —á–∞—Ç—É

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `http://localhost:8080/chat`
2. –í–≤–µ–¥–∏—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ Basic Auth (WEB_ADMIN_USER –∏ WEB_ADMIN_PASS)
3. –û—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∏—Å—Ç–æ—Ä–∏–µ–π —á–∞—Ç–∞

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

- –í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –≤–Ω–∏–∑—É
- –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å" –∏–ª–∏ Enter
- –°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ engine'–æ–º –∫–∞–∫ –æ–±—ã—á–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ê–≥–µ–Ω—Ç—ã –æ—Ç–≤–µ—Ç—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ù–∞–≤–∏–≥–∞—Ü–∏—è

- –ù–∞–∂–º–∏—Ç–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ —á–∞—Ç–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–æ–ª–µ–π
- –ù–∞–∂–º–∏—Ç–µ –∏–∫–æ–Ω–∫—É –ª—É–Ω—ã/—Å–æ–ª–Ω—Ü–∞ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
- –ß–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä–æ–ª–ª–∏—Ç—Å—è –∫ –Ω–æ–≤—ã–º —Å–æ–æ–±—â–µ–Ω–∏—è–º

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
Frontend (chat.html)
    ‚Üì
API Routes (web_server.py)
    ‚îú‚îÄ‚îÄ GET /chat                          ‚Üí render template
    ‚îú‚îÄ‚îÄ GET /api/chat/history              ‚Üí load history from FileStorage
    ‚îú‚îÄ‚îÄ GET /api/chat/updates?last_index=N ‚Üí polling for new messages
    ‚îî‚îÄ‚îÄ POST /api/chat/message             ‚Üí send & process message via engine
    ‚Üì
FileStorage
    ‚Üì
NeuroCrewLab (engine)
    ‚Üì
Agent Responses ‚Üí FileStorage ‚Üí Both Telegram & Web UI
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

1. **–û–±—â–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**: FileStorage –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏ –¥–ª—è Telegram –±–æ—Ç–∞, –∏ –¥–ª—è –≤–µ–±-—á–∞—Ç–∞
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π**: –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∏–∑ Telegram –∏–ª–∏ –≤–µ–±–∞) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –æ–¥–Ω–∏–º engine'–æ–º
3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –ö–æ–≥–¥–∞ –∞–≥–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç, –µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ FileStorage –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤–µ–∑–¥–µ

### Polling vs WebSocket

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **polling** (–∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã), —á—Ç–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è MVP:
- **–ü–ª—é—Å—ã**: –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **–ú–∏–Ω—É—Å—ã**: –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ (–¥–æ 2 —Å–µ–∫), –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

–î–ª—è production –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ WebSocket –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

## API Reference

### GET /api/chat/history

–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞.

**Response:**
```json
{
  "messages": [
    {
      "role": "user",
      "role_display": "User",
      "text": "Hello",
      "timestamp": "2024-11-21T10:30:00"
    },
    {
      "role": "agent",
      "role_display": "Software Developer",
      "text": "Hi! How can I help?",
      "timestamp": "2024-11-21T10:30:05"
    }
  ],
  "total": 2
}
```

### GET /api/chat/updates?last_index=0

–ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏–Ω–¥–µ–∫—Å–∞ (–¥–ª—è polling).

**Query Parameters:**
- `last_index` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö)

**Response:**
```json
{
  "messages": [
    {
      "role": "agent",
      "role_display": "Code Reviewer",
      "text": "Code looks good!",
      "timestamp": "2024-11-21T10:31:00"
    }
  ]
}
```

### POST /api/chat/message

–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è engine'–æ–º).

**Request:**
```json
{
  "text": "Please review this code"
}
```

**Response:**
```json
{
  "success": true,
  "message": "Message sent and processed"
}
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
WEB_ADMIN_USER=admin          # Basic auth username
WEB_ADMIN_PASS=password       # Basic auth password
TARGET_CHAT_ID=12345          # Chat ID –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏
```

### Polling –∏–Ω—Ç–µ—Ä–≤–∞–ª

–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É –≤ `templates/chat.html`:

```javascript
updateInterval = setInterval(pollUpdates, 2000); // 2000ms = 2 sec
```

## –¢–µ—Å—Ç—ã

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã –≤–µ–±-—á–∞—Ç–∞
pytest tests/test_web_chat.py -v

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/test_web_chat.py::test_api_send_message_empty_text -v
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ

- ‚úÖ Authentication (8 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ Chat history loading
- ‚úÖ Message polling
- ‚úÖ Message sending
- ‚úÖ Error handling

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Python

```python
import requests
import json

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
url = "http://localhost:8080/api/chat/message"
headers = {
    "Authorization": "Basic YWRtaW46cGFzc3dvcmQ=",
    "Content-Type": "application/json"
}
data = {"text": "What should we implement next?"}

response = requests.post(url, json=data, headers=headers)
print(response.json())
```

### JavaScript (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ frontend)

```javascript
// –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
const response = await fetch('/api/chat/history');
const data = await response.json();
console.log(`Loaded ${data.total} messages`);

// –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
const response = await fetch('/api/chat/message', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ text: 'Your message here' })
});
const result = await response.json();
console.log(result.success ? 'Sent!' : 'Error');
```

## Troubleshooting

### –ß–∞—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Basic Auth —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `TARGET_CHAT_ID` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `.env`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –Ω–∞ –æ—à–∏–±–∫–∏

### –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ agent'—ã –≤–∫–ª—é—á–µ–Ω—ã –≤ `roles/agents.yaml`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ CLI –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç: `python main.py`
3. –£–≤–µ–ª–∏—á—å—Ç–µ polling –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### Basic Auth –æ—à–∏–±–∫–∏

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `WEB_ADMIN_USER` –∏ `WEB_ADMIN_PASS` –≤ `.env`
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è header'–∞: `Authorization: Basic base64(user:pass)`

## –†–∞–∑–≤–∏—Ç–∏–µ

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–Ω–µ –≤—Ö–æ–¥—è—Ç –≤ MVP)

- üîî WebSocket –≤–º–µ—Å—Ç–æ polling –¥–ª—è –º–µ–Ω—å—à–µ–π –∑–∞–¥–µ—Ä–∂–∫–∏
- üìù –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- üë• –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üîç –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏
- üìä Analytics dashboard
- üé§ Voice messages
- üìé File uploads

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f data/logs/ncrew.log`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã: `pytest tests/test_web_chat.py -v`
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ: `README.md`
